<html>
    <head>
        
    </head>
    <body>
        <button id="enableButton">enable SnapAlgo</button>
        <script src="dist/index_bundle.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/algosdk@1.16.0/dist/browser/algosdk.min.js"></script>
        <button id="getHealthButton">get health</button>
        <button id="encodeTransactionButton">encodeTransaction</button>
        <script>
            const snapalgo = new SnapAlgo.Wallet();
            document.getElementById('getHealthButton').addEventListener('click', () => {
                getHealth();
            });
            console.log(window.algorand)
            document.getElementById('enableButton').addEventListener('click', function() {
                
                algorand.enable();
            });
            document.getElementById("encodeTransactionButton").addEventListener("click", encodeTransaction);
            async function getHealth(){
                let client = await algorand.getAlgorandV2Client();
                console.log(client)
                let health =  await client.get('/health')
                console.log(health)
                const algodClient = new algosdk.Algodv2(client);
                console.log(algodClient)
                let status = await algodClient.status().do();
                console.log("status is")
                console.log(status)
                let block = await algodClient.block(18038133).do();
                console.log("block is")
                console.log(block)
            }

            async function encodeTransaction(){
                let client = await algorand.getAlgorandV2Client();
                const algodClient = new algosdk.Algodv2(client);
                let params = await algodClient.getTransactionParams().do();
                const receiver = "HZ57J3K46JIJXILONBBZOHX6BKPXEM2VVXNRFSUED6DKFD5ZD24PMJ3MVA";
                const sender = '37G4YMHO2N4MBRUN4NMUIZEOO5A44UMKRF26O3WIN7WRUTDPT6Z2NU46RE';
                let txn = algosdk.makePaymentTxnWithSuggestedParamsFromObject({
                from: sender, 
                to: receiver, 
                amount: 1000000,  
                suggestedParams: params
                });
                let encoded = algorand.snapAlgoEncodeTxn(txn);
                console.log(encoded);
            }

            async function signTransaction(){
                let client = await algorand.getAlgorandV2Client();
                const algodClient = new algosdk.Algodv2(client);
                let params = await algodClient.getTransactionParams().do();
                const receiver = "HZ57J3K46JIJXILONBBZOHX6BKPXEM2VVXNRFSUED6DKFD5ZD24PMJ3MVA";
                const sender = '37G4YMHO2N4MBRUN4NMUIZEOO5A44UMKRF26O3WIN7WRUTDPT6Z2NU46RE';
                let txn = algosdk.makePaymentTxnWithSuggestedParamsFromObject({
                from: sender, 
                to: receiver, 
                amount: 1000000,  
                suggestedParams: params
                });
                let signedTxn = await ethereum.request({
                method: 'wallet_invokeSnap',
                params: ["npm:algorand", {
                    method: 'signTxns',
                    txns: txn
                }]
                })
            };

            
        </script>
    </body>
</html>

